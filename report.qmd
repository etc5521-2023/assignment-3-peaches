---
title: "MY WILD THING REPORT"
author: "Peaches: Tanish and Ashvin"
format: html
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,message = FALSE,warning = FALSE)
```

## Introduction

<!-- 
1. For your assigned Australian wild thing, read all you can about it, and write a paragraph describing it's key features, such as it's habitat, usual active time, whether numbers are increasing or declining, and even things like, if it is common for tourists to travel to see them, or there are special spotting promotions occurring as is happening [this month for the platypus](https://platypus.asn.au/report-a-sighting/). The write five unique expectations on what you might find when you explore the data, for example: 
<br><br>"We expect to see the occurrences only in the summer months."
<br>"We expect to find the most occurrences near the coast."
<br>"We expect to observe declining numbers since 1994."
<br><br> Be as specific as reasonably possible for your wild thing!
-->

```{r, message=FALSE}
# Load libraries
library(galah)
library(tidyverse)
library(ggplot2)
library(nullabor)
```

The Brush-Tailed Bettong or Woylie is a mammal that is endemci to Australia, living in forests and shrublands. Unfortunately, the Woylie is on the brink of extermination with its numbers severely decreasing over the hundred years or so. It is therefore now categorize as a critically endangered species and is protected by the government of Australia. Most of the remnants of the Woylie population reside in wildlife sanctuaries, where they live in a predator free environment.

From this data we expect the following results:

- "We expect the occurences to be declining over the past 20 years."
- "We expect there to be fewer sightings in the wild over the past few years as they are mostly in protected sanctuaries."
- "We expect that there will not be many sightings near many weather stations as they reside in only select areas around Australia."


## Data description

<!--
2. Download all the occurrence records from the Atlas of Living Australia, ideally scripted using the `atlas_occurrences()` function from the `galah` package. Make sure you include date, time, collector identification details. Save this into a `data-raw` folder in your repo.
-->

```{r, eval=FALSE}
# load occurence records for woylie from ALA
galah_config(email = "aran0026@student.monash.edu")
woylie<-
  galah_call() %>%
  galah_identify("Bettongia penicillata ogilbyi") %>%
  atlas_occurrences()

# save data as a csv in data-raw folder
write.csv(woylie,file = "data-raw/woylie.csv")
```

```{r}
# load data back into R environment
woylie <- read_csv("data-raw/woylie.csv")

# remove unnecessary 1st column
woylie <- woylie[,-1]
```

## Initial data analysis

<!--
3. Perform a data quality check, and then go ahead and clean the data, saving only the wild sightings. Save the resulting data in a `data` folder as an `WILD_THING_COMMON_NAME.rda` file, so that any special variable types are clearly available. (Replace `WILD_THING_COMMON_NAME` with lower case common name of your assigned wild thing.) *Note:* Some are museum or historical records or live in an animal sanctuary or zoo, which do not truly capture their wild behaviour. Downloading the event information (`galah_select(group = "event")`) can help identify wild sightings.

Weather data pre-processing here too.
-->

```{r}
# Data quality check

# view any missing variables and variable types
visdat::vis_dat(woylie)
```

- Missing values appear to be only in "eventDate" column with a few in the decimal longitude and latitude, every other aspect of the variables seem to be correct.

We will check the data resource where event date is a missing value.

```{r}
# Check why event date has missing value corresponding to their dataResource name
woylie%>% filter(is.na(eventDate))%>% select(dataResourceName)%>% unique()

# Check the number of observations that there are missing values 
woylie%>% filter(is.na(eventDate))%>% select(dataResourceName)%>% nrow()

# Check how many of the event Dates in this location are NA
woylie%>% filter(dataResourceName == "Western Australian Museum provider for OZCAM") %>% select(eventDate)%>% unique()
```
- Its only the event dates recorded by the "Western Australian Museum provider for OZCAM" that are missing, and all of their event dates of 182 recordings are missing. 

We will check the data resource where decimal longitude and latitude is missing. They will be checked together as according to the figure above the same observstions for both appear to be missing.
```{r}
# Check the data resource name where decimal longitude is missing
woylie%>% filter(is.na(decimalLongitude), is.na(decimalLatitude))%>% 
  select(dataResourceName)%>% unique()

# check the number of observations for which it is missing
woylie%>% filter(is.na(decimalLongitude), is.na(decimalLatitude))%>% 
  select(dataResourceName)%>% nrow()
```
- As we saw earlier there are a total of 182 observations recorded by the *"Western Australian Museum provider for OZCAM"*. 19 of these recordings have missing values in the "decimal longitude" and "decimal latitude" columns.

```{r, eval=FALSE}
galah_config(email = "aran0026@student.monash.edu")
woylie_sightings<-
  galah_call() %>%
  galah_identify("Bettongia penicillata ogilbyi") %>%
  galah_select(group = "event")%>%
  atlas_occurrences()

# remove unecessary columns
woylie_sightings <-
  woylie_sightings[,c("eventDate","samplingEffort","samplingProtocol")]

write.csv(woylie_sightings, file = "data-raw/woylie_sightings.csv")
```


```{r, eval=FALSE}
# reorder columns to make it easily readable after join
woylie<- woylie[,c("eventDate","decimalLatitude", "decimalLongitude",
                   "scientificName","taxonConceptID","recordID",
                   "dataResourceName","occurrenceStatus")]

woylie_sightings<- read_csv("data-raw/woylie_sightings.csv")

# remove unecessary first column in woylie sightings
woylie_sightings<- woylie_sightings[,-1]

#join the data sets
WILD_THING_woylie<-
  woylie%>% 
  left_join(woylie_sightings, by = "eventDate")%>%
  unique()

#view different sampling protocols to identify wild sighting protocols
unique(WILD_THING_woylie$samplingProtocol)

#filter wild sightings
WILD_THING_woylie<-
  WILD_THING_woylie%>% 
  filter(samplingProtocol %in% c("Camera Trapping",
                                 "Transect Spotlighting",
                                 "Sign-diggings",
                                 "Observed-spotlighting",
                                 "Sign-dropping" ))
```


```{r, eval=FALSE}
save(WILD_THING_woylie,file = "data/WILD_THING_woylie.rda")
```

## Exploratory data analysis

<!--
4. Make plots of the data to check each of your expectations, and report what you learn. *Note:* This might also be a place where visual inference methods *may* be useful to determine if what is seen agrees or disputes what you expected. 

Weather data exploration here too.
-->

```{r}
# load the wild sightings data back in

load(file = "data/WILD_THING_woylie.rda")
```


## Summary 

## References
